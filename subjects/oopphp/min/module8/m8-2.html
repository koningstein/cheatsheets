<!DOCTYPE html>
<html lang="nl" data-theme="light" data-color="blue">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Connectie & Configuratie - OOP PHP Module 8</title>

    <script src="../../../../assets/js/theme-init.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="../../../../assets/css/style.css">
</head>
<body>

<div data-include="../../../../components/header.html"></div>

<div class="layout-wrapper">
    <div data-include="../../../../components/sidebar.html"></div>

    <main class="main-content">
        <h1>Connectie & Configuratie</h1>

        <div class="info-box">
            <h3>De Tolk: PDO</h3>
            <p>PHP praat niet direct met MySQL. Daar zit een laag tussen. Vroeger gebruikten we <code>mysqli</code>, maar tegenwoordig is <strong>PDO</strong> (PHP Data Objects) de standaard.</p>
            <p>Waarom PDO? Omdat het een universele "tolk" is. Als je ooit besluit om over te stappen van MySQL naar PostgreSQL of SQLite, hoef je met PDO bijna niets aan je code te veranderen.</p>
        </div>

        <h3>Veiligheid Eerst: Het .env Bestand</h3>
        <p>Het is een doodzonde om wachtwoorden in je PHP-code te zetten. Als je je code deelt op GitHub, heeft de hele wereld toegang tot je database.</p>
        <p>Daarom gebruiken we "Environment Variables". We maken een bestand genaamd <code>.env</code> dat we <strong>nooit</strong> delen (het staat in <code>.gitignore</code>).</p>

        <pre><code class="language-ini"># .env bestand
DB_HOST=localhost
DB_NAME=blackjack_db
DB_USER=root
DB_PASS=geheim123</code></pre>

        <h3>De Verbinding Maken</h3>
        <p>In onze database-klasse gebruiken we deze gegevens om de verbinding te openen. Dit doen we in een <code>try-catch</code> blok, want er kan van alles misgaan (server down, verkeerd wachtwoord).</p>



        <pre><code class="language-php">class MysqlDatabase implements Database
{
    private PDO $connection;

    public function __construct()
    {
        // Haal credentials uit de omgeving (.env)
        $host = $_ENV['DB_HOST'];
        $db   = $_ENV['DB_NAME'];
        $user = $_ENV['DB_USER'];
        $pass = $_ENV['DB_PASS'];

        // DSN: Data Source Name (de connectie string)
        $dsn = "mysql:host=$host;dbname=$db;charset=utf8mb4";

        try {
            // Maak de verbinding
            $this->connection = new PDO($dsn, $user, $pass);

            // Zorg dat PDO foutmeldingen geeft als er iets mis is
            $this->connection->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

            // Zorg dat we arrays terugkrijgen
            $this->connection->setAttribute(PDO::ATTR_DEFAULT_FETCH_MODE, PDO::FETCH_ASSOC);

        } catch (PDOException $e) {
            // Als het mislukt, stop en toon de fout
            die("Database verbinding mislukt: " . $e->getMessage());
        }
    }
}</code></pre>

        <div class="info-box">
            <h3>De Database Manager</h3>
            <p>Het openen van een verbinding kost tijd. Daarom willen we dit niet voor elk query opnieuw doen. Vaak gebruiken we een <strong>DatabaseManager</strong> (een statische hulpklasse) om de verbinding één keer te maken en daarna te hergebruiken.</p>
        </div>

        <pre><code class="language-php">// In index.php (aan het begin)
$db = new MysqlDatabase();
DatabaseManager::setConnection($db);

// Later in het spel...
$db = DatabaseManager::getConnection(); // Hergebruik de bestaande verbinding</code></pre>

    </main>

    <aside class="sidebar-right">
        <div class="toc-container">
            <h4>Inhoud</h4>
            <ul id="toc-list" class="toc-list">
            </ul>
        </div>
    </aside>
</div>

<div data-include="../../../../components/footer.html"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="../../../../assets/js/script.js"></script>
</body>
</html>