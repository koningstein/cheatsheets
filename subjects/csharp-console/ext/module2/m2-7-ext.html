<!DOCTYPE html>
<html lang="nl" data-theme="light" data-color="purple">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Call Stack (Ext) - C# Module 2</title>

    <script src="../../../../assets/js/theme-init.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="../../../../assets/css/style.css">
</head>
<body>

<div data-include="../../../../components/header.html"></div>

<div class="layout-wrapper">
    <div data-include="../../../../components/sidebar.html"></div>

    <main class="main-content">
        <h1>De Call Stack: Waar ben ik?</h1>

        <p>Als je aan het debuggen bent, staar je vaak naar één regel code (de gele balk). Maar soms vraag je je af: <em>"Hoe ben ik hier eigenlijk terechtgekomen?"</em> of <em>"Wie heeft deze functie aangeroepen?"</em></p>
        <p>Om dit te begrijpen, moeten we kijken naar de <strong>Call Stack</strong> (De Aanroep Stapel). Dit is jouw GPS-systeem tijdens het debuggen.</p>

        <h3>Hoe werken methodes onder water?</h3>
        <p>Programma's zijn eigenlijk een lange ketting van methodes die elkaar aanroepen. Zolang de bovenste methode niet klaar is, staan alle methodes daaronder "in de wacht".</p>

        <div class="info-box">
            <h3>De Vergelijking: De Stapel Afwas</h3>
            <p>Stel je voor dat je de afwas doet.</p>
            <ul>
                <li>Je pakt een groot bord (<strong>Main</strong>) en legt het in het sop.</li>
                <li>Bovenop dat bord leg je een kleiner bordje (<strong>Sleep</strong>).</li>
                <li>Bovenop dat bordje leg je een kopje (<strong>UpdateStatus</strong>).</li>
            </ul>
            <p>Je bent nu bezig met het kopje (de bovenste). Het grote bord onderop (Main) ligt er nog wel, maar je kunt er niet bij zolang de stapel erop ligt. Dit is precies hoe de <strong>Call Stack</strong> werkt: De methode waar je NU bent, ligt bovenop.</p>
        </div>


        <h3>Dieper de code in</h3>
        <p>Om dit te testen, moeten we zorgen dat onze methodes elkaar gaan aanroepen. We gaan de <code>Sleep</code> methode uitbreiden zodat hij een "hulp-methode" aanroept.</p>

        <h4>Stap 1: Pas DigitalPet.cs aan</h4>
        <p>Pas je bestaande `Sleep` methode aan. We roepen een nieuwe methode aan die de honger bijwerkt (want van slapen krijg je honger).</p>

        <pre><code class="language-csharp">// IN BESTAND: DigitalPet.cs

public string Sleep()
{
    this.IsSleeping = true;
    this.Energy += 20;

    // NIEUW: We roepen vanuit hier weer een andere methode aan!
    UpdateStatus();

    return "Zzz... Dat deed deugd! (+20 Energie)";
}

// Een hulp-methode (zet deze ergens onderaan in je class)
public void UpdateStatus()
{
    // Omdat we slapen, gaat de tijd voorbij en krijgen we honger.
    // Zet HIER je Breakpoint (F9) op de regel hieronder:
    this.Hunger += 5;
}</code></pre>

        <h4>Stap 2: Starten maar</h4>
        <p>In <code>Program.cs</code> hoef je niks te veranderen. Die roept namelijk `dino.Sleep()` al aan.</p>
        <ol>
            <li>Zorg dat het <strong>Breakpoint</strong> (rode bol) in de nieuwe methode <code>UpdateStatus</code> staat (op de regel <code>this.Hunger += 5;</code>).</li>
            <li>Druk op <strong>F5</strong>.</li>
        </ol>

        <h3>De Call Stack Bekijken</h3>
        <p>Het programma stopt nu in `UpdateStatus`. Kijk rechtsonder in Visual Studio naar het tabblad <strong>Call Stack</strong>.</p>
        <p>Je ziet nu precies de stapel methodes die "open" staan:</p>

        <pre>
1. UpdateStatus  (Hier ben je nu - Bovenop de stapel)
2. Sleep         (Deze methode wacht tot UpdateStatus klaar is)
3. Main          (Deze methode wacht tot Sleep klaar is)
        </pre>

        <h3>Tijdreizen</h3>
        <p>Het mooie is: je kunt op de regels in de Call Stack <strong>dubbelklikken</strong>.</p>
        <ol>
            <li>Dubbelklik op <code>Main</code> (de onderste in de lijst).</li>
            <li>Visual Studio springt direct naar <code>Program.cs</code>.</li>
            <li>Je ziet een <strong>Groene Pijl</strong>. Die geeft aan: <em>"Hier was ik gebleven voordat ik Sleep aanriep."</em></li>
        </ol>
        <p>Dit is superhandig om te achterhalen <em>waarom</em> een methode werd aangeroepen met bepaalde data.</p>

        <h3>Wat kan er fout gaan? (Veelgemaakte Fouten)</h3>

        <div class="info-box warning">
            <h3>⚠️ Stack Overflow (De Oneindige Lus)</h3>
            <p>De ruimte op de stapel is niet oneindig. Als methode A methode B aanroept, en methode B roept methode A weer aan... dan blijft de stapel groeien tot het geheugen op is.</p>
        </div>

        <p>Probeer deze fout maar eens te maken (doe dit niet in een serieus project!):</p>
        <pre><code class="language-csharp">public string Sleep()
{
    // Oeps! Sleep roept ZICHZELF aan, in plaats van UpdateStatus
    // Dit blijft doorgaan tot je computer crasht.
    return Sleep();
}</code></pre>
        <p>Als je dit start, crasht je programma direct met een <strong>System.StackOverflowException</strong>. De stapel borden is omgevallen.</p>

        <h3>Samenvatting</h3>
        <ul>
            <li>De <strong>Call Stack</strong> laat zien welke route je programma heeft afgelegd.</li>
            <li>De huidige methode staat <strong>bovenop</strong> de stapel.</li>
            <li>Je kunt <strong>dubbelklikken</strong> in de lijst om terug te kijken in vorige methodes.</li>
        </ul>

    </main>

    <aside class="sidebar-right">
        <div class="toc-container">
            <h4>Inhoud</h4>
            <ul id="toc-list" class="toc-list">
            </ul>
        </div>
    </aside>
</div>

<div data-include="../../../../components/footer.html"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="../../../../assets/js/script.js"></script>
</body>
</html>