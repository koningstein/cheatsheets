<!DOCTYPE html>
<html lang="nl" data-theme="light" data-color="red">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Middleware Beveiliging</title>

    <script src="../../../../assets/js/theme-init.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="../../../../assets/css/style.css">
</head>
<body>

<div data-include="../../../../components/header.html"></div>

<div class="layout-wrapper">
    <div data-include="../../../../components/sidebar.html"></div>

    <main class="main-content">
        <h1>Middleware Beveiliging</h1>
        <p>Alleen een inlogfunctionaliteit bouwen is niet genoeg. Je moet je applicatie ook daadwerkelijk beschermen. Stel je voor dat je een `dashboard` pagina hebt. Zonder beveiliging kan iedereen die de URL `/dashboard` raadt, deze pagina bezoeken, zelfs zonder in te loggen.</p>

        <h2>Leeruitkomsten</h2>
        <ul style="margin-bottom: 2rem;">
            <li>Ik begrijp wat middleware is en hoe het werkt als poortwachter.</li>
            <li>Ik kan de `auth` middleware toepassen om routes te beveiligen.</li>
            <li>Ik weet hoe ik route-groepen kan maken voor efficiënte beveiliging.</li>
            <li>Ik begrijp de functie van de `guest` middleware.</li>
        </ul>

        <h3>Middleware: De Poortwachters</h3>
        <p>Hiervoor gebruiken we <strong>Middleware</strong>. Zie middleware als een reeks "poortwachters" waar een verzoek doorheen moet voordat het bij je applicatie (je Livewire component of controller) komt. Als de poortwachter zegt "Stop, je mag er niet in", wordt het verzoek afgebroken of doorgestuurd (bijvoorbeeld naar de login pagina).</p>

        <h3>Routes Beveiligen met `auth`</h3>
        <p>De belangrijkste middleware is <code>auth</code>. Deze controleert of de gebruiker is ingelogd. Zo niet, dan redirect hij de gebruiker naar de login route. In Laravel 12 (zeker met Livewire Volt/Class components) definieer je routes vaak direct gekoppeld aan de component.</p>
        <p>Het is 'best practice' om routes te groeperen. Zo vergeet je nooit per ongeluk één specifieke route te beveiligen.</p>

        <div class="note-box">Bestand: <code>routes/web.php</code></div>
        <pre><code class="language-php">
use App\Livewire\Dashboard;
use App\Livewire\Projects\Index as ProjectIndex;
use App\Livewire\Projects\Create as ProjectCreate;

// Alle routes binnen deze groep zijn ALLEEN toegankelijk voor ingelogde users.
// We voegen vaak ook 'verified' toe, zodat mensen eerst hun e-mail moeten bevestigen.
Route::middleware(['auth', 'verified'])->group(function () {

    // Dashboard
    Route::get('/dashboard', Dashboard::class)->name('dashboard');

    // Projecten beheer
    Route::get('/projects', ProjectIndex::class)->name('projects.index');
    Route::get('/projects/create', ProjectCreate::class)->name('projects.create');
});
        </code></pre>

        <h3>De `guest` Middleware</h3>
        <p>Er is ook een omgekeerd scenario. Pagina's zoals <strong>Login</strong>, <strong>Registreren</strong> en <strong>Wachtwoord Vergeten</strong> zijn bedoeld voor gasten (niet-ingelogde gebruikers). Als je al bent ingelogd, is het verwarrend en nutteloos om het inlogscherm te zien.</p>
        <p>Hiervoor gebruik je de <code>guest</code> middleware. Als een ingelogde gebruiker een route met deze middleware probeert te bezoeken, stuurt Laravel ze automatisch door naar de `HOME` route (meestal `/dashboard`).</p>

        <div class="note-box">Bestand: <code>routes/auth.php</code> (of web.php)</div>
        <pre><code class="language-php">
use App\Livewire\Auth\Login;
use App\Livewire\Auth\Register;

// Deze routes zijn alleen voor GASTEN
Route::middleware('guest')->group(function () {

    Route::get('register', Register::class)
        ->name('register');

    Route::get('login', Login::class)
        ->name('login');

    // ... wachtwoord reset routes ...
});
        </code></pre>

        <h3>Hoe werkt de Redirect?</h3>
        <p>Je vraagt je misschien af: "Hoe weet Laravel waar hij naartoe moet redirecten?".</p>
        <ul>
            <li><strong>Niet ingelogd (auth fail):</strong> Laravel kijkt in <code>bootstrap/app.php</code> (of vroeger `Authenticate` middleware) en stuurt je naar de route genaamd `login`.</li>
            <li><strong>Wel ingelogd (guest fail):</strong> Laravel kijkt in de <code>App\Providers\AppServiceProvider</code> (of de hardcoded `RouteServiceProvider` in oudere versies) naar de `HOME` constante. Vaak is dit `/dashboard`.</li>
        </ul>
    </main>

    <aside class="sidebar-right">
        <div class="toc-container">
            <h4>Inhoud</h4>
            <ul id="toc-list" class="toc-list">
            </ul>
        </div>
    </aside>
</div>

<div data-include="../../../../components/footer.html"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="../../../../assets/js/script.js"></script>
</body>
</html>