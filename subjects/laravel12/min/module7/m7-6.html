<!DOCTYPE html>
<html lang="nl" data-theme="light" data-color="red">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collections Methods</title>

    <script src="../../../../assets/js/theme-init.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="../../../../assets/css/style.css">
</head>
<body>

<div data-include="../../../../components/header.html"></div>

<div class="layout-wrapper">
    <div data-include="../../../../components/sidebar.html"></div>

    <main class="main-content">
        <h1>Collections Methods</h1>
        <p>Wanneer je data ophaalt met Eloquent (bijvoorbeeld <code>Product::all()</code> of <code>$order->products</code>), krijg je <strong>geen</strong> simpele array terug, maar een <code>Illuminate\Database\Eloquent\Collection</code> object.</p>
        <p>Dit object is een "super-array" met honderden handige methodes om je data te filteren, sorteren en manipuleren <em>nadat</em> het uit de database is gehaald.</p>

        <div class="note-box">
            <strong>Let op:</strong> Collection methods werken <strong>in het geheugen</strong> (PHP), niet in de database (SQL). Als je miljoenen rijen hebt, gebruik dan Query Builder methods (<code>where</code>, <code>orderBy</code>) om te filteren <em>voordat</em> je de data ophaalt.
        </div>

        <h2>Leeruitkomsten</h2>
        <ul style="margin-bottom: 2rem;">
            <li>Ik begrijp het verschil tussen Collections en arrays.</li>
            <li>Ik kan Collections filteren met <code>filter()</code>.</li>
            <li>Ik kan lijsten maken met <code>pluck()</code> voor dropdowns en overzichten.</li>
            <li>Ik kan data transformeren met <code>map()</code>.</li>
            <li>Ik kan items zoeken met <code>firstWhere()</code>.</li>
            <li>Ik kan Collection methods chainen voor krachtige data manipulatie.</li>
        </ul>

        <h3>1. Filteren (filter)</h3>
        <p>Met <code>filter</code> kun je items uit de lijst halen op basis van complexe logica die je misschien niet makkelijk in SQL kunt schrijven.</p>

        <div class="note-box">Bestand: <code>app/Http/Controllers/ProductController.php</code></div>
        <pre><code class="language-php">
$products = Product::all(); // Haal alles op (Collection)

// Filter producten die duurder zijn dan 100 euro
// De originele $products blijft ongewijzigd, $expensive is een nieuwe collection
$expensive = $products->filter(function ($product) {
    // Return true om het item te bewaren, false om weg te gooien
    return $product->price > 100;
});
        </code></pre>

        <h3>2. Lijstjes maken (pluck)</h3>
        <p>Vaak heb je alleen een lijstje van namen of ID's nodig, bijvoorbeeld voor een dropdown menu in een formulier. <code>pluck</code> is daar perfect voor.</p>

        <pre><code class="language-php">
// Geeft een simpele array terug: ['Laptop', 'Muis', 'Toetsenbord']
$names = $products->pluck('name');

// Geeft een key-value array (handig voor <option>): [1 => 'Laptop', 5 => 'Muis']
// Eerste parameter is de waarde, tweede parameter is de key (ID)
$list = $products->pluck('name', 'id');
        </code></pre>

        <h3>3. Transformeren (map)</h3>
        <p>Met <code>map</code> kun je elk item in de collectie aanpassen. Dit is handig als je data wilt formatteren voor je view of API.</p>

        <pre><code class="language-php">
$formatted = $products->map(function ($product) {
    // We voegen een eigenschap toe (tijdelijk, niet in DB)
    $product->price_inc_tax = $product->price * 1.21;

    return $product;
});
        </code></pre>

        <h3>4. Zoeken (firstWhere)</h3>
        <p>Als je snel één item uit de collectie wilt halen op basis van een waarde.</p>

        <pre><code class="language-php">
// Vind het eerste product waar 'is_active' true is
$firstActive = $products->firstWhere('is_active', true);

// Vind het product met ID 5 (alternatief voor find() als je de data al hebt)
$specific = $products->firstWhere('id', 5);
        </code></pre>

        <h3>5. Chaining (Kettingreactie)</h3>
        <p>De echte kracht van Collections is dat je methodes aan elkaar kunt rijgen ("chainen"). Dit maakt je code zeer leesbaar.</p>

        <pre><code class="language-php">
$result = $products
    ->filter(fn($p) => $p->is_active)      // 1. Pak alleen actieve producten
    ->sortByDesc('price')                  // 2. Sorteer hoogste prijs eerst
    ->take(5)                              // 3. Pak de top 5
    ->pluck('name');                       // 4. Geef alleen de namen terug

// $result is nu een lijstje met de namen van de 5 duurste actieve producten.
        </code></pre>
    </main>

    <aside class="sidebar-right">
        <div class="toc-container">
            <h4>Inhoud</h4>
            <ul id="toc-list" class="toc-list">
            </ul>
        </div>
    </aside>
</div>

<div data-include="../../../../components/footer.html"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="../../../../assets/js/script.js"></script>
</body>
</html>