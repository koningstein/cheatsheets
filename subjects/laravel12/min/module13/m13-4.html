<!DOCTYPE html>
<html lang="nl" data-theme="light" data-color="red">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Refactoring naar Pest</title>

    <script src="../../../../assets/js/theme-init.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="../../../../assets/css/style.css">
</head>
<body>

<div data-include="../../../../components/header.html"></div>

<div class="layout-wrapper">
    <div data-include="../../../../components/sidebar.html"></div>

    <main class="main-content">
        <h1>Refactoring naar Pest</h1>
        <p>We hebben gezien hoe PHPUnit werkt met classes en methodes. Dat is prima, maar het kan veel beknopter. Nu gaan we dezelfde tests herschrijven naar Pest. Dit laat goed zien hoe je bestaande kennis toepast in de nieuwe, modernere syntax.</p>

        <h2>Leeruitkomsten</h2>
        <ul style="margin-bottom: 2rem;">
            <li>Ik kan een PHPUnit Unit test herschrijven naar Pest.</li>
            <li>Ik kan een PHPUnit Feature test herschrijven naar Pest.</li>
            <li>Ik kan tests groeperen met de `describe()` functie.</li>
        </ul>

        <h3>1. Unit Test (Refactored)</h3>
        <p>Herinner je de <code>PriceCalculatorTest</code>? In PHPUnit moesten we een class maken die overerfde van <code>TestCase</code>. In Pest hebben we geen class structuur nodig. We kunnen direct beginnen met testen.</p>

        <div class="note-box">Bestand: <code>tests/Unit/PriceCalculatorTest.php</code></div>
        <pre><code class="language-php">
use App\Services\PriceCalculator;

// In plaats van 'public function test_it_calculates...'
// gebruiken we gewoon de test() functie.
test('it calculates 21 percent vat correctly', function () {
    // 1. Arrange
    $calculator = new PriceCalculator();

    // 2. Act
    $result = $calculator->calculateVat(100.00, 21);

    // 3. Assert (met de fijne expect syntax)
    expect($result)->toBe(121.00);
});
        </code></pre>

        <h3>2. Feature Test (Refactored)</h3>
        <p>Ook Feature tests zijn veel compacter. Je hebt nog steeds toegang tot alle handige Laravel helpers zoals <code>get()</code>, <code>post()</code> en <code>actingAs()</code>. Deze zijn beschikbaar via <code>$this</code> binnen de closure, of zelfs direct als functie in sommige Pest-configuraties.</p>
        <p>We gebruiken hier <code>it()</code> omdat dat lekkerder leest: "It shows the projects page".</p>

        <div class="note-box">Bestand: <code>tests/Feature/ProjectTest.php</code></div>
        <pre><code class="language-php">
it('shows the projects page with correct content', function () {
    // We kunnen assertions ketenen (chaining)
    $this->get('/projects')
        ->assertStatus(200)
        ->assertSee('Onze Projecten')
        ->assertDontSee('Server Error');
});
        </code></pre>

        <h3>Grouping met `describe()`</h3>
        <p>In PHPUnit groepeer je tests door ze in één class te zetten (bijv. <code>AuthenticationTest</code>). Omdat Pest geen classes gebruikt, zou je kunnen denken dat je het overzicht verliest. Gelukkig is er de <code>describe()</code> functie.</p>
        <p>Hiermee kun je tests logisch bij elkaar clusteren. Dit is niet alleen voor de leesbaarheid van je code, maar ook voor de output in je terminal.</p>

        <pre><code class="language-php">
describe('authentication', function () {

    // Al deze tests horen bij 'authentication'

    test('login page is visible', function () {
        $this->get('/login')->assertStatus(200);
    });

    test('users can authenticate', function () {
        // ... login logica ...
    });

    test('invalid password gives error', function () {
        // ... error logica ...
    });

});
        </code></pre>

        <p>Als je dit draait, zie je in de terminal een mooi kopje "Authentication" met daaronder de specifieke tests.</p>
    </main>

    <aside class="sidebar-right">
        <div class="toc-container">
            <h4>Inhoud</h4>
            <ul id="toc-list" class="toc-list">
            </ul>
        </div>
    </aside>
</div>

<div data-include="../../../../components/footer.html"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="../../../../assets/js/script.js"></script>
</body>
</html>