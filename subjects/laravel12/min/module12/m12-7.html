<!DOCTYPE html>
<html lang="nl" data-theme="light" data-color="red">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Artisan Commands</title>

    <script src="../../../../assets/js/theme-init.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="../../../../assets/css/style.css">
</head>
<body>

<div data-include="../../../../components/header.html"></div>

<div class="layout-wrapper">
    <div data-include="../../../../components/sidebar.html"></div>

    <main class="main-content">
        <h1>Artisan Commands</h1>
        <p>Je kent Artisan al van commando's als <code>php artisan migrate</code> of <code>php artisan make:controller</code>. Maar wist je dat je ook je eigen commando's kunt schrijven? Dit is extreem krachtig voor beheertaken, cronjobs en imports.</p>

        <h2>Leeruitkomsten</h2>
        <ul style="margin-bottom: 2rem;">
            <li>Ik kan zelf custom Artisan commando's aanmaken en configureren.</li>
            <li>Ik begrijp hoe ik input argumenten kan verwerken in een commando.</li>
            <li>Ik weet hoe ik commando's automatisch kan laten uitvoeren via de Scheduler.</li>
        </ul>

        <h3>Waarom: Automatisering</h3>
        <p>Stel je wilt elke nacht om 03:00 uur alle onbetaalde bestellingen ouder dan 30 dagen annuleren. Of je wilt een script dat data importeert uit een CSV bestand zonder dat je daarvoor een webpagina hoeft te bouwen (die misschien timed-out). Hier zijn Artisan Commands voor bedoeld.</p>

        <h3>Hoe: Commando Maken</h3>
        <p>Gebruik <code>php artisan make:command CleanupOrders</code>. Dit maakt een bestand in <code>app/Console/Commands</code>.</p>

        <div class="note-box">Bestand: <code>app/Console/Commands/CleanupOrders.php</code></div>
        <pre><code class="language-php">
namespace App\Console\Commands;

use Illuminate\Console\Command;
use App\Models\Order;

class CleanupOrders extends Command
{
    // De 'signature' is wat je typt in de terminal
    // {days} is een optioneel argument met default waarde 30
    protected $signature = 'orders:cleanup {days=30}';

    protected $description = 'Annuleer onbetaalde orders ouder dan X dagen';

    public function handle()
    {
        // Argument ophalen
        $days = $this->argument('days');

        $this->info("Bezig met opruimen van orders ouder dan $days dagen...");

        // Logica uitvoeren
        $count = Order::where('status', 'pending')
            ->where('created_at', '<', now()->subDays($days))
            ->update(['status' => 'cancelled']);

        // Feedback geven aan de gebruiker (in de terminal)
        if ($count > 0) {
            $this->info("$count orders zijn geannuleerd.");
        } else {
            $this->warn("Geen orders gevonden om te annuleren.");
        }
    }
}
        </code></pre>

        <h3>Hoe: Uitvoeren en Plannen</h3>
        <p>Je kunt je commando nu direct testen in de terminal:</p>
        <div class="note-box">Terminal</div>
        <pre><code class="language-bash">php artisan orders:cleanup 7</code></pre>

        <p>Om dit automatisch te laten lopen, voeg je het toe aan de Scheduler in <code>routes/console.php</code> (in Laravel 11/12 is dit de nieuwe plek, ipv Kernel.php).</p>

        <div class="note-box">Bestand: <code>routes/console.php</code></div>
        <pre><code class="language-php">
use Illuminate\Support\Facades\Schedule;

// Voer het commando elke nacht uit
Schedule::command('orders:cleanup')->dailyAt('03:00');
        </code></pre>
    </main>

    <aside class="sidebar-right">
        <div class="toc-container">
            <h4>Inhoud</h4>
            <ul id="toc-list" class="toc-list">
            </ul>
        </div>
    </aside>
</div>

<div data-include="../../../../components/footer.html"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="../../../../assets/js/script.js"></script>
</body>
</html>