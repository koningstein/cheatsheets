<!DOCTYPE html>
<html lang="nl" data-theme="light" data-color="red">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Import & Export</title>

    <script src="../../../../assets/js/theme-init.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="../../../../assets/css/style.css">
</head>
<body>

<div data-include="../../../../components/header.html"></div>

<div class="layout-wrapper">
    <div data-include="../../../../components/sidebar.html"></div>

    <main class="main-content">
        <h1>Excel Import & Export</h1>
        <p>Voor veel bedrijven draait de wereld om spreadsheets. Klanten willen rapportages kunnen downloaden om ze zelf te analyseren, of ze willen grote hoeveelheden data (zoals een nieuwe prijslijst) in één keer uploaden. De standaard package hiervoor is <strong>Laravel Excel</strong> (<code>maatwebsite/excel</code>).</p>

        <h2>Leeruitkomsten</h2>
        <ul style="margin-bottom: 2rem;">
            <li>Ik kan data exporteren naar Excel met behulp van Export Classes.</li>
            <li>Ik kan data importeren vanuit Excel met behulp van Import Classes.</li>
            <li>Ik begrijp het voordeel van het scheiden van logica in aparte classes (Separation of Concerns).</li>
        </ul>

        <h3>Excel Integratie</h3>

        <h3>Waarom: Separation of Concerns</h3>
        <p>Je zou de logica om een CSV te bouwen in je controller kunnen schrijven, maar dat wordt snel rommelig. Laravel Excel introduceert <strong>Export Classes</strong> en <strong>Import Classes</strong>. Hierdoor blijft je controller schoon en is de Excel-logica herbruikbaar.</p>

        <h3>Hoe: Data Exporteren</h3>
        <p>Eerst maak je een Export class aan: <code>php artisan make:export UsersExport --model=User</code>. In deze class definieer je wat er in de Excel moet komen.</p>

        <div class="note-box">Bestand: <code>app/Exports/UsersExport.php</code></div>
        <pre><code class="language-php">
namespace App\Exports;

use App\Models\User;
use Maatwebsite\Excel\Concerns\FromCollection;
use Maatwebsite\Excel\Concerns\WithHeadings;

// De interfaces bepalen de functionaliteit (bijv. wel/geen headers)
class UsersExport implements FromCollection, WithHeadings
{
    public function collection()
    {
        // Selecteer alleen de kolommen die je wilt tonen
        return User::select('name', 'email', 'created_at')->get();
    }

    public function headings(): array
    {
        return ['Naam', 'E-mailadres', 'Lid sinds'];
    }
}
        </code></pre>

        <p>In je controller roep je deze class vervolgens aan om de download te starten.</p>

        <div class="note-box">Bestand: <code>app/Http/Controllers/UserController.php</code></div>
        <pre><code class="language-php">
use App\Exports\UsersExport;
use Maatwebsite\Excel\Facades\Excel;

public function export()
{
    return Excel::download(new UsersExport, 'users.xlsx');
}
        </code></pre>

        <h3>Hoe: Data Importeren</h3>
        <p>Importeren is complexer omdat je data moet valideren en verwerken. Maak een Import class: <code>php artisan make:import UsersImport --model=User</code>.</p>

        <div class="note-box">Bestand: <code>app/Imports/UsersImport.php</code></div>
        <pre><code class="language-php">
use App\Models\User;
use Maatwebsite\Excel\Concerns\ToModel;
use Maatwebsite\Excel\Concerns\WithHeadingRow; // Sla de eerste regel over

class UsersImport implements ToModel, WithHeadingRow
{
    public function model(array $row)
    {
        // $row bevat de data uit één regel van de Excel
        return new User([
            'name'     => $row['naam'], // matcht met kolomkop in excel
            'email'    => $row['email'],
            'password' => bcrypt('welkom123'),
        ]);
    }
}
        </code></pre>

        <p>De controller handelt de upload af en start de import:</p>

        <div class="note-box">Bestand: <code>app/Http/Controllers/UserController.php</code></div>
        <pre><code class="language-php">
use App\Imports\UsersImport;

public function import(Request $request)
{
    $request->validate(['file' => 'required|mimes:xlsx,csv']);

    Excel::import(new UsersImport, $request->file('file'));

    return redirect()->back()->with('success', 'Gebruikers geïmporteerd!');
}
        </code></pre>
    </main>

    <aside class="sidebar-right">
        <div class="toc-container">
            <h4>Inhoud</h4>
            <ul id="toc-list" class="toc-list">
            </ul>
        </div>
    </aside>
</div>

<div data-include="../../../../components/footer.html"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="../../../../assets/js/script.js"></script>
</body>
</html>